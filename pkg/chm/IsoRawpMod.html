<html><head><title>~~function to do ... ~~</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>IsoRawpMod(IsoGeneGUI)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   IsoRawpMod">
<param name="keyword" value=" ~~function to do ... ~~">
</object>


<h2>~~function to do ... ~~</h2>


<h3>Description</h3>

<p>
~~ A concise (1-5 lines) description of what the function does. ~~
</p>


<h3>Usage</h3>

<pre>
IsoRawpMod(x, y, niter, seed)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
~~Describe <code>x</code> here~~ </td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
~~Describe <code>y</code> here~~ </td></tr>
<tr valign="top"><td><code>niter</code></td>
<td>
~~Describe <code>niter</code> here~~ </td></tr>
<tr valign="top"><td><code>seed</code></td>
<td>
~~Describe <code>seed</code> here~~ </td></tr>
</table>

<h3>Details</h3>

<p>
~~ If necessary, more details than the description above ~~
</p>


<h3>Value</h3>

<p>
~Describe the value returned
If it is a LIST, use
</p>
<table summary="R argblock">
<tr valign="top"><td><code>comp1 </code></td>
<td>
Description of 'comp1'</td></tr>
<tr valign="top"><td><code>comp2 </code></td>
<td>
Description of 'comp2'</td></tr>
</table>
<p>

...</p>

<h3>Warning</h3>

<p>
....
</p>


<h3>Note</h3>

<p>
~~further notes~~ 
</p>
<p>
~Make other sections like Warning with section{Warning }{....} ~
</p>


<h3>Author(s)</h3>

<p>
~~who you are~~
</p>


<h3>References</h3>

<p>
~put references to the literature/web site here ~
</p>


<h3>See Also</h3>

<p>
~~objects to See Also as <code><a onclick="findlink('utils', 'help.html')" style="text-decoration: underline; color: blue; cursor: hand">help</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--    or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (x, y, niter, seed) 
  {
    if (niter &gt; 2500) {
        jmatsize &lt;- 2500
        nmats &lt;- floor(niter/jmatsize)
        endmat &lt;- c(1:nmats * jmatsize, niter)
        begmat &lt;- c(1, endmat[-length(endmat)] + 1)
    }
    else {
        nmats &lt;- 1
        begmat &lt;- 1
        endmat &lt;- niter
    }
    y &lt;- data.matrix(y, rownames.force = TRUE)
    E &lt;- IsoGenem(x, y)
    obs.E.up &lt;- matrix(E[[1]], nrow(y), 1)
    obs.W.up &lt;- E[[2]]
    obs.WC.up &lt;- E[[3]]
    obs.M.up &lt;- E[[4]]
    obs.I.up &lt;- E[[5]]
    obs.E.dn &lt;- E[[6]]
    obs.W.dn &lt;- E[[7]]
    obs.WC.dn &lt;- E[[8]]
    obs.M.dn &lt;- E[[9]]
    obs.I.dn &lt;- E[[10]]
    dire &lt;- E[[11]]
    StatVal &lt;- E 
    assign("StatVal",StatVal ,envir=.GlobalEnv)
    rm(E)

#### Calculating statistics ##
CalcStat ()

    nchunks &lt;- 10
    chunklength &lt;- floor(nrow(y)/nchunks)
    endpos &lt;- c(1:(nchunks - 1) * chunklength, nrow(y))
    begpos &lt;- c(1, endpos[-length(endpos)] + 1)
    options(warn = -1)
    exp.E.up &lt;- ff("exp.E.up", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.W.up &lt;- ff("exp.W.up", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.WC.up &lt;- ff("exp.WC.up", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.M.up &lt;- ff("exp.M.up", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.I.up &lt;- ff("exp.I.up", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.E.dn &lt;- ff("exp.E.dn", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.W.dn &lt;- ff("exp.W.dn", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.WC.dn &lt;- ff("exp.WC.dn", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.M.dn &lt;- ff("exp.M.dn", vmode = "double", dim = c(nrow(y), 
        niter))
    exp.I.dn &lt;- ff("exp.I.dn", vmode = "double", dim = c(nrow(y), 
        niter))
    set.seed(seed)
    x.niter &lt;- t(replicate(niter, sample(x)))
    ffmatrices &lt;- c("exp.E.up", "exp.W.up", "exp.WC.up", "exp.M.up", 
        "exp.I.up", "exp.E.dn", "exp.W.dn", "exp.WC.dn", "exp.M.dn", 
        "exp.I.dn")
    obsvecs &lt;- c("obs.E.up", "obs.W.up", "obs.WC.up", "obs.M.up", 
        "obs.I.up", "obs.E.dn", "obs.W.dn", "obs.WC.dn", "obs.M.dn", 
        "obs.I.dn")
    compvec &lt;- c("&lt;", "&lt;", "&lt;", "&lt;", "&lt;", "&lt;", "&gt;", "&gt;", "&gt;", 
        "&gt;")
    outnames &lt;- c("raw1.up", "raw2.up", "raw3.up", "raw4.up", 
        "raw5.up", "raw1.dn", "raw2.dn", "raw3.dn", "raw4.dn", 
        "raw5.dn")
    raw1.up &lt;- raw2.up &lt;- raw3.up &lt;- raw4.up &lt;- raw5.up &lt;- raw1.dn &lt;- raw2.dn &lt;- raw3.dn &lt;- raw4.dn &lt;- raw5.dn &lt;- nrow(y)
    for (ichunk in seq(along = begpos)) {
        begchunk &lt;- begpos[ichunk]
        endchunk &lt;- endpos[ichunk]
        suby &lt;- y[begchunk:endchunk, ]
        for (jmat in 1:nmats) {
            jbegmat &lt;- begmat[jmat]
            jendmat &lt;- endmat[jmat]
            ncolmat &lt;- jendmat - jbegmat + 1
            subx.niter &lt;- x.niter[jbegmat:jendmat, ]
            res &lt;- apply(subx.niter, 1, function(x) IsoGenem(x = factor(x), 
                y = suby))
            exp.E.up[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[1]])
            exp.W.up[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[2]])
            exp.WC.up[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[3]])
            exp.M.up[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[4]])
            exp.I.up[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[5]])
            exp.E.dn[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[6]])
            exp.W.dn[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[7]])
            exp.WC.dn[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[8]])
            exp.M.dn[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[9]])
            exp.I.dn[begchunk:endchunk, jbegmat:jendmat] &lt;- sapply(res, 
                function(x) x[[10]])

  # if (jmat  &lt; nmats) { tclvalue(PermuteText3 ) &lt;- "Please wait...." }
  #else {tclvalue(PermuteText3 ) &lt;- "Permutation is finished...."}

  tclvalue(PermuteText3 ) &lt;- "Please wait...."

        }
        for (i in seq(along = ffmatrices)) {
            lhs &lt;- as.list(quote(OBSVEC[begchunk:endchunk]))
            lhs[[2]] &lt;- as.name(obsvecs[i])
            rhs &lt;- as.list(quote(FFMAT[begchunk:endchunk, ]))
            rhs[[2]] &lt;- as.name(ffmatrices[i])
            rsarg &lt;- as.call(list(as.name(compvec[i]), as.call(lhs), 
                as.call(rhs)))
            RHS &lt;- as.call(list(as.name("rowSums"), rsarg))
            LHS &lt;- as.list(quote(OUTNAME[begchunk:endchunk]))
            LHS[[2]] &lt;- as.name(outnames[i])
            finalcall &lt;- as.call(list(as.name("&lt;-"), as.call(LHS), 
                as.call(RHS)))
            eval(finalcall)
        }
    }
    rm(suby)
    rm(res)
    rm(subx.niter)
    raw.p.up &lt;- data.frame(raw1.up/niter, raw2.up/niter, raw3.up/niter, 
        raw4.up/niter, raw5.up/niter)
    raw.p.dn &lt;- data.frame(raw1.dn/niter, raw2.dn/niter, raw3.dn/niter, 
        raw4.dn/niter, raw5.dn/niter)
    rm(raw1.up, raw2.up, raw3.up, raw4.up, raw5.up, raw1.dn, 
        raw2.dn, raw3.dn, raw4.dn, raw5.dn)
    rawp.up &lt;- data.frame(row.names(y), raw.p.up)
    rawp.dn &lt;- data.frame(row.names(y), raw.p.dn)
    raw.p.one &lt;- data.frame(row.names(y), apply(cbind(raw.p.up[, 
        1], raw.p.dn[, 1]), 1, min), apply(cbind(raw.p.up[, 2], 
        raw.p.dn[, 2]), 1, min), apply(cbind(raw.p.up[, 3], raw.p.dn[, 
        3]), 1, min), apply(cbind(raw.p.up[, 4], raw.p.dn[, 4]), 
        1, min), apply(cbind(raw.p.up[, 5], raw.p.dn[, 5]), 1, 
        min))
    raw.p.two &lt;- raw.p.one
    raw.p.two[, 2:6] &lt;- 2 * (raw.p.one[, 2:6])
    raw.p.two[, 2:6][raw.p.two[, 2:6] &gt; 1] &lt;- 1
    colnames(raw.p.one) &lt;- colnames(raw.p.two) &lt;- colnames(rawp.up) &lt;- colnames(rawp.dn) &lt;- c("Probe.ID", 
        "E2", "Williams", "Marcus", "M", "ModM")
    res &lt;- list(raw.p.one = raw.p.one, raw.p.two = raw.p.two, 
        rawp.up = rawp.up, rawp.dn = rawp.dn, niter=niter)
    rm(exp.E.up, exp.W.up, exp.WC.up, exp.M.up, exp.I.up, exp.E.dn, 
        exp.W.dn, exp.WC.dn, exp.M.dn, exp.I.dn)
    gc()
    return(res)
options(warn = 0)
tclvalue(PermuteText3 ) &lt;- "Permutation is finished...."
  }
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>IsoGeneGUI</em> version 1.0 <a href="00Index.html">Index</a>]</div>

</body></html>
