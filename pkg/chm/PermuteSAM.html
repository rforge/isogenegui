<html><head><title>~~function to do ... ~~</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="Rchm.css">
</head>
<body>

<table width="100%"><tr><td>PermuteSAM(IsoGeneGUI)</td><td align="right">R Documentation</td></tr></table><object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
<param name="keyword" value="R:   PermuteSAM">
<param name="keyword" value=" ~~function to do ... ~~">
</object>


<h2>~~function to do ... ~~</h2>


<h3>Description</h3>

<p>
~~ A concise (1-5 lines) description of what the function does. ~~
</p>


<h3>Usage</h3>

<pre>
PermuteSAM()
</pre>


<h3>Details</h3>

<p>
~~ If necessary, more details than the description above ~~
</p>


<h3>Value</h3>

<p>
~Describe the value returned
If it is a LIST, use
</p>
<table summary="R argblock">
<tr valign="top"><td><code>comp1 </code></td>
<td>
Description of 'comp1'</td></tr>
<tr valign="top"><td><code>comp2 </code></td>
<td>
Description of 'comp2'</td></tr>
</table>
<p>

...</p>

<h3>Warning</h3>

<p>
....
</p>


<h3>Note</h3>

<p>
~~further notes~~ 
</p>
<p>
~Make other sections like Warning with section{Warning }{....} ~
</p>


<h3>Author(s)</h3>

<p>
~~who you are~~
</p>


<h3>References</h3>

<p>
~put references to the literature/web site here ~
</p>


<h3>See Also</h3>

<p>
~~objects to See Also as <code><a onclick="findlink('utils', 'help.html')" style="text-decoration: underline; color: blue; cursor: hand">help</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre>
##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--    or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function() {

if (!exists("exprs") | !exists("dose"))  
   {  
      ReturnVal &lt;- tkmessageBox(title="Error Message",message="Load the data first!",icon="error",type="ok")
if (tclvalue(ReturnVal)== "ok") tkfocus(tt)
  } 
else {

 samPermute &lt;&lt;-tktoplevel()
tkwm.title(samPermute,"Significance Analysis of Microarrays (SAM) - IsoGene GUI") 
      spec.frm &lt;- tkframe(samPermute,borderwidth=2)
frame1 &lt;- tkframe(spec.frm, relief="groove", borderwidth=2)
frame1.1 &lt;- tkframe(frame1 ,  borderwidth=2)
frame1.2 &lt;- tkframe(frame1 ,  borderwidth=2)
frame1.3 &lt;- tkframe(frame1 ,  borderwidth=2)
frame1.4 &lt;- tkframe(frame1 ,  borderwidth=2)

frame2 &lt;- tkframe(frame1 ,relief="groove",  borderwidth=2)
frame2.1 &lt;- tkframe(frame2 ,  borderwidth=2)
frame3 &lt;- tkframe(frame2 ,relief="groove", borderwidth=2)
frame3.1 &lt;- tkframe(frame3 , borderwidth=2)

buttonFramesam&lt;-tkframe(samPermute,borderwidth=2)

### Select the RAW P value  ##
      rb3 &lt;- tkradiobutton( frame1 )
rb4 &lt;- tkradiobutton( frame1.4 )
rbValue2 &lt;- tclVar("new")

tkconfigure(rb3,variable=rbValue2,value="new",text="New Permutation")
tkconfigure(rb4,variable=rbValue2,value="old", text="Obtain the permutation result from a file:")
      
### Select genes ##
rb1 &lt;- tkradiobutton( frame1.1 )
rb2 &lt;- tkradiobutton( frame1.1)
rbValue1 &lt;- tclVar("all")
tkconfigure(rb1,variable=rbValue1,value="all",text="All Genes")
tkconfigure(rb2,variable=rbValue1,value="range", text="Genes Range")

fromgene&lt;- tclVar("")
FromNum&lt;-tkentry(frame1.1,width="8",textvariable=fromgene)

togene &lt;- tclVar("")
ToNum&lt;-tkentry(frame1.1,width="8",textvariable=togene )

      tkgrid(rb3)
tkgrid.configure(rb3,sticky="w")
tkgrid( tklabel(frame1.1,text="Select the genes: "))
   
tkgrid(rb1)
tkgrid(rb2,tklabel(frame1.1,text="From"),FromNum,tklabel(spec.frm,text="To"),ToNum)

tkgrid.configure(frame1.1, sticky="w")

### Select Using Fudge Factor  ##
      rb5 &lt;- tkradiobutton( frame2.1 )
rb6 &lt;- tkradiobutton( frame2.1)
   rb7 &lt;- tkradiobutton( frame2.1)
rbValue3 &lt;- tclVar("no")

tkconfigure(rb5 ,variable=rbValue3 ,value="no",text="No fudge factor")
tkconfigure(rb6 ,variable=rbValue3 ,value="pooled", text="Automatic")
      tkconfigure(rb7 ,variable=rbValue3 ,value="specFudge", text="Specify percentile for S0:")

fudgeSpec &lt;- tclVar("")
FudgeEdit &lt;-tkentry(frame2.1,width="4",textvariable=fudgeSpec )
     labFudge &lt;- tklabel(frame2.1,text="e.g. 5,45,100")

tkgrid.configure(tklabel(frame2.1,text="Specify Fudge Factor (S0):") , sticky="w")

tkgrid.configure(rb5 , sticky="w")
tkgrid.configure(rb6, sticky="w")

tkgrid.configure(rb7 ,FudgeEdit ,labFudge ,sticky="w")

#########

### Select the statistic value for SE and CV plot ##
rb8 &lt;- tkradiobutton( frame3.1)
rb9 &lt;- tkradiobutton( frame3.1)
rb10 &lt;- tkradiobutton( frame3.1)
rb11 &lt;- tkradiobutton( frame3.1)
rb12 &lt;- tkradiobutton( frame3.1)
rbValue4 &lt;- tclVar("ModM")

tkconfigure(rb8 ,variable=rbValue4 ,value="E2",text="E2")
tkconfigure(rb9,variable=rbValue4 ,value="Williams", text="Williams")
tkconfigure(rb10,variable=rbValue4 ,value="Marcus",text="Marcus")
tkconfigure(rb11,variable=rbValue4 ,value="M", text="M")    
tkconfigure(rb12,variable=rbValue4 ,value="ModM",text="M'")

tkgrid.configure(tklabel(frame3,text="Fudge plots:") , sticky="w")

lab1 &lt;- tklabel(frame3.1,text="Statistic:")
tkgrid.configure(lab1 ,rb8 ,rb9,rb10,rb11,rb12, sticky="w") 
tkgrid.configure(frame3.1,sticky="w")
########
cb6 &lt;- tkcheckbutton(frame3 )
cbValue6 &lt;- tclVar("1")
tkconfigure(cb6,variable=cbValue6,text="Standar error plot")

cb8 &lt;- tkcheckbutton(frame3 )
cbValue8 &lt;- tclVar("0")
tkconfigure(cb8,variable=cbValue8,text="CV plot")

   ShowSEplot &lt;- function()
  {

  rbVal1 &lt;- as.character(tclvalue(rbValue1))
  rbVal3 &lt;- as.character(tclvalue(rbValue3))
  fudgeVal &lt;- as.numeric(tclvalue(fudgeSpec ))
  cbVal6 &lt;- as.character(tclvalue(cbValue6))
  cbVal8 &lt;- as.character(tclvalue(cbValue8))

pct &lt;- (0:20) *10/ 2
if(rbVal3 == "specFudge"  &amp; is.element(fudgeVal ,pct) == F) {
 tkmessageBox(title="Error Message",message="You can only input percentile value: 0, 5, 10, 15, 20,..., 
100!",icon="warning",type="ok")
  }
else {

rbVal4 &lt;- as.character(tclvalue(rbValue4))
if (rbVal4 == "E2" ) statUsed &lt;- "E2"
if (rbVal4 == "Williams" ) statUsed &lt;- "Williams"
if (rbVal4 == "Marcus" ) statUsed &lt;- "Marcus"
if (rbVal4 == "M" ) statUsed &lt;- "M"
if (rbVal4 == "ModM" ) statUsed &lt;- "ModM"

if (rbVal1=="all") {
      exprs2SAM &lt;- exprs
matchID &lt;- c(1:nrow(exprs2SAM ))
  }
      if (rbVal1=="range") {
       exprs2SAM &lt;- exprs[tclvalue(fromgene):tclvalue(togene),] 
matchID &lt;- c(tclvalue(fromgene):tclvalue(togene))
      }
  if (exists("matchIDtemp")) {
 if (setequal(matchID,matchIDtemp)== F)  {
IsoStat (dose,exprs2SAM )
fudgeRes &lt;&lt;- IsofudgeMod(dose,exprs2SAM, stat=statUsed ,fudge="auto")
  }

 }

        else { IsoStat (dose,exprs2SAM ) 
 fudgeRes &lt;&lt;- IsofudgeMod(dose,exprs2SAM, stat=statUsed ,fudge="auto")

  }

if (rbVal3 == "no") { 

if (cbVal6 =="1") {
   plotSe &lt;- function () {SEPlot (statUsed,0)}
Plot2(plotSe  ,1.5,1.5,title=paste("Windows Graph Output: Standar error plot for ",statUsed ))
  }
      if (cbVal8 =="1") {
    plotCV &lt;- function () {CVPlot (fudgeRes [[2]])}
    Plot2(plotCV ,1.5,1.5,title=paste("Windows Graph Output: CV plot ",statUsed ))
  }
      }
if (rbVal3 == "pooled") { 

if (cbVal6 =="1") {
plotSe &lt;- function () {SEPlot (statUsed,fudgeRes [[1]])}
Plot2(plotSe  ,1.5,1.5,title=paste("Windows Graph Output: Standar error plot for ",statUsed ))
  }

if (cbVal8 =="1") {
plotCV &lt;- function () {CVPlot (fudgeRes [[2]])}
Plot2(plotCV ,1.5,1.5,title=paste("Windows Graph Output: CV plot ",statUsed ))
  }
  }

if (rbVal3 == "specFudge") { 
fudgeRes &lt;- IsofudgeMod(dose,exprs2SAM , stat=statUsed ,fudge=fudgeVal )

if (cbVal6 =="1") {
plotSe &lt;- function () {SEPlot (statUsed,fudgeRes [[1]])}
Plot2(plotSe  ,1.5,1.5,title=paste("Windows Graph Output: Standar error plot for ",statUsed ))
  }
if (cbVal8 =="1") {
plotCV &lt;- function () {CVPlot (fudgeRes [[2]])}
Plot2(plotCV ,1.5,1.5,title=paste("Windows Graph Output: CV plot ",statUsed ))
  }
  }
        matchIDtemp &lt;&lt;- matchID 
   }
  }

  ShowSEplot.but &lt;-tkbutton(frame3,text=" Display",command=ShowSEplot)

tkgrid.configure(cb6 , sticky="w")
tkgrid.configure(cb8 ,tklabel(frame3,text=""), ShowSEplot.but, sticky="w")

tkgrid.configure(frame2.1,frame3, sticky="w")
tkgrid.configure(frame2, sticky="w")

### Permutation ###
numperm&lt;- tclVar("100")
NumPerm &lt;-tkentry(frame1.2 ,width="5",textvariable=numperm)
label.numperm &lt;- tklabel(frame1.2,text="    Number of Permutation: ")
tkgrid(label.numperm,NumPerm )
tkgrid.configure(label.numperm,sticky="w")

cb7 &lt;- tkcheckbutton(frame1.2)
cbValue7&lt;- tclVar("0")
tkconfigure(cb7,variable=cbValue7,text="Save the permutations result:")

      Save.but &lt;-tkbutton(frame1.2,text="browse",command=savingRwd )
      SavefileName &lt;&lt;- tclVar("")
fileEdit &lt;-tkentry(frame1.2,width="30",textvariable=SavefileName )

      tkgrid.configure(frame1.2,sticky="w")
      tkgrid.configure(cb7,Save.but,fileEdit,sticky="w")
tkgrid( tklabel(frame1,text="                "))

Calc.PermutSAM &lt;- function () 
  {

  rbVal1 &lt;- as.character(tclvalue(rbValue1))
  rbVal2 &lt;&lt;- as.character(tclvalue(rbValue2))
        NumPermval &lt;- as.numeric(tclvalue(numperm))
       cbVal7 &lt;- as.character(tclvalue(cbValue7))
   rbVal3 &lt;- as.character(tclvalue(rbValue3))
    fudgeVal &lt;&lt;- as.numeric(tclvalue(fudgeSpec ))

  assign("NumPermval",NumPermval,envir=.GlobalEnv)
  tkconfigure(samPermute,cursor="watch")
   tclvalue(PermuteText1 ) &lt;- " please wait..... " 
     tclvalue(PermuteText2 ) &lt;- " "
  fudgeOpt &lt;- 0
   if (rbVal2 == "old") { 
ReturnVal &lt;- tkmessageBox(title="Error Message",message="You have choosen the wrong option !",icon="warning",type="ok")
  if (tclvalue(ReturnVal)== "ok") tkfocus(samPermute)
                }
  if (rbVal2 == "new") {
      if (rbVal1=="all") {
      exprs2SAM &lt;&lt;- exprs
matchID &lt;&lt;- c(1:nrow(exprs2SAM ))
  }
      if (rbVal1=="range") {
       exprs2SAM &lt;&lt;- exprs[tclvalue(fromgene):tclvalue(togene),] 
matchID &lt;&lt;- c(tclvalue(fromgene):tclvalue(togene))
      }

     }
## Calculating the qqStat values ### 

   
  SAMRes &lt;-IsoqqstatMOD(dose, exprs2SAM, fudge=rbVal3 , niter=NumPermval , seed= SeedNum )
  N &lt;- nrow (exprs2SAM)
     
  ## specify the fudge option ##
  if (rbVal3 == "pooled") fdgopt &lt;- "Automatic"  
  if (rbVal3 == "no") fdgopt &lt;- "None" 
  if (rbVal3 == "specFudge") fdgopt &lt;- paste (fudgeVal,"percentile") 

  tkdelete(treeWidget,"nodeSAM")
  try( tkdelete(treeWidget,"PermSAMNode"), silent=T)
  tkinsert(treeWidget,"end","Record4Node","PermSAMNode",text="SAM Permutations ")
  tkinsert(treeWidget,"end","PermSAMNode","NumGeneSAMNode",text= paste("Number genes analyzed: ",N )  )
  tkinsert(treeWidget,"end","PermSAMNode","FudgeNode",text= paste("Fudge Factor: ",fdgopt) )
  tkinsert(treeWidget,"end","PermSAMNode","NumpermSAMNode",text= paste("Number permutations: ",NumPermval )  )

  DirectionSAM &lt;&lt;- SAMRes [[11]] 
  SAMRes [[12]] &lt;- NumPermval 
    SAMRes [[13]]  &lt;- fdgopt 
        assign("SAMRes.temp",SAMRes ,envir=.GlobalEnv)
        assign("exprs2SAM.temp",exprs2SAM ,envir=.GlobalEnv)

   MeanDiffSAM  &lt;&lt;- MeanDiff (dose,exprs2SAM )
        assign("MeanDiffSAM",MeanDiffSAM  ,envir=.GlobalEnv)

        if (cbVal7=="1") 
    {
split &lt;- strsplit(fileRwd,".",fixed=TRUE)
fileName &lt;- paste(split[[1]][1],".RData",sep="")
save(SAMRes , file=fileName )
ReturnVal &lt;- tkmessageBox(message="The permutation have finished and been saved",icon="info",type="ok")
      if (tclvalue(ReturnVal)== "ok") tkfocus(samPermute)
      tkconfigure(samPermute,cursor="arrow")
    }
     else {
     ReturnVal &lt;-tkmessageBox(message="The permutation have been finished. Do you want to save the permutation?",
       icon="question",type="yesno",default="yes")

     if (tclvalue(ReturnVal)== "no") {
  tkfocus(samPermute)
   }

     if (tclvalue(ReturnVal)== "yes")
            {
    savingRwd ()
    save(SAMRes ,file=fileRwd )
    tkfocus(samPermute)
                }

     tkconfigure(samPermute,cursor="arrow")
     }
  }


Calculate.but &lt;-tkbutton(frame1.3,text=" Run Permutation ",command=Calc.PermutSAM)
PermuteText1 &lt;&lt;- tclVar("     ")
label1 &lt;- tklabel(frame1.3,text=tclvalue(PermuteText1 ))
tkconfigure(label1,textvariable=PermuteText1 )
PermuteText2 &lt;&lt;- tclVar("     ")
label2 &lt;- tklabel(frame1.3,text=tclvalue(PermuteText2 ))
tkconfigure(label2,textvariable=PermuteText2 )

tkgrid.configure(Calculate.but,label1,label2,sticky="w")

tkgrid( tklabel(frame1.3,text="                "))
      
tkgrid.configure(frame1.3,sticky="w")

Open.but &lt;-tkbutton(frame1.4 ,text="browse",command=browse2)
      pvalName &lt;&lt;- tclVar("       ")
pvalEdit &lt;-tkentry(frame1.4,width="30",textvariable=pvalName )

      tkgrid(rb4,Open.but,pvalEdit )
tkgrid.configure(rb4,sticky="w")
   
tkgrid.configure(frame1.4,sticky="w")

tkgrid(frame1)

onCancel &lt;- function()
  {
     ReturnVal &lt;&lt;- 0
  try(rm(SAMRes.temp,exprs2SAM.temp,envir=.GlobalEnv), silent=T)
  tkdestroy(samPermute)
  }

onOK &lt;- function()
  {

    assign("SAMRes",SAMRes.temp ,envir=.GlobalEnv)
 assign("exprs2SAM",exprs2SAM.temp ,envir=.GlobalEnv)
       if (exists ("exprs2SAM.temp")  )  try(rm(exprs2SAM.temp,envir=.GlobalEnv), silent=T)
       if (exists ("SAMRes.temp")  )  try(rm(SAMRes.temp,envir=.GlobalEnv), silent=T)

 tkdestroy(samPermute)
  }
  Exit.but &lt;-tkbutton(buttonFramesam,text=" Cancel",command=onCancel )
  Ok.but &lt;-tkbutton(buttonFramesam,text="  Ok  ",command=onOK )

  tkgrid(Ok.but,Exit.but)
  tkgrid.configure(Ok.but,Exit.but,sticky="e")

  tkgrid(spec.frm)
  tkgrid(buttonFramesam)
 
 }
  }
</pre>

<script Language="JScript">
function findlink(pkg, fn) {
var Y, link;
Y = location.href.lastIndexOf("\\") + 1;
link = location.href.substring(0, Y);
link = link + "../../" + pkg + "/chtml/" + pkg + ".chm::/" + fn;
location.href = link;
}
</script>


<hr><div align="center">[Package <em>IsoGeneGUI</em> version 1.0 <a href="00Index.html">Index]</a></div>

</body></html>
